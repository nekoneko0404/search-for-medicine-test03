(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,52683,e=>{"use strict";var s=e.i(43476),t=e.i(71645);let a=e=>{let s=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,s,t)=>t?t.toUpperCase():s.toLowerCase());return s.charAt(0).toUpperCase()+s.slice(1)},r=(...e)=>e.filter((e,s,t)=>!!e&&""!==e.trim()&&t.indexOf(e)===s).join(" ").trim();var l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let n=(0,t.forwardRef)(({color:e="currentColor",size:s=24,strokeWidth:a=2,absoluteStrokeWidth:n,className:i="",children:c,iconNode:d,...o},m)=>(0,t.createElement)("svg",{ref:m,...l,width:s,height:s,stroke:e,strokeWidth:n?24*Number(a)/Number(s):a,className:r("lucide",i),...!c&&!(e=>{for(let s in e)if(s.startsWith("aria-")||"role"===s||"title"===s)return!0})(o)&&{"aria-hidden":"true"},...o},[...d.map(([e,s])=>(0,t.createElement)(e,s)),...Array.isArray(c)?c:[c]])),i=(e,s)=>{let l=(0,t.forwardRef)(({className:l,...i},c)=>(0,t.createElement)(n,{ref:c,iconNode:s,className:r(`lucide-${a(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,l),...i}));return l.displayName=a(e),l},c=i("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]),d=i("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),o=i("baby",[["path",{d:"M10 16c.5.3 1.2.5 2 .5s1.5-.2 2-.5",key:"1u7htd"}],["path",{d:"M15 12h.01",key:"1k8ypt"}],["path",{d:"M19.38 6.813A9 9 0 0 1 20.8 10.2a2 2 0 0 1 0 3.6 9 9 0 0 1-17.6 0 2 2 0 0 1 0-3.6A9 9 0 0 1 12 3c2 0 3.5 1.1 3.5 2.5s-.9 2.5-2 2.5c-.8 0-1.5-.4-1.5-1",key:"11xh7x"}],["path",{d:"M9 12h.01",key:"157uk2"}]]),m=i("pill",[["path",{d:"m10.5 20.5 10-10a4.95 4.95 0 1 0-7-7l-10 10a4.95 4.95 0 1 0 7 7Z",key:"wa1lgi"}],["path",{d:"m8.5 8.5 7 7",key:"rvfmvr"}]]),x=i("activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]),h=i("milk",[["path",{d:"M8 2h8",key:"1ssgc1"}],["path",{d:"M9 2v2.789a4 4 0 0 1-.672 2.219l-.656.984A4 4 0 0 0 7 10.212V20a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-9.789a4 4 0 0 0-.672-2.219l-.656-.984A4 4 0 0 1 15 4.788V2",key:"qtp12x"}],["path",{d:"M7 15a6.472 6.472 0 0 1 5 0 6.47 6.47 0 0 0 5 0",key:"ygeh44"}]]),p=i("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),g=i("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),u=i("stethoscope",[["path",{d:"M11 2v2",key:"1539x4"}],["path",{d:"M5 2v2",key:"1yf1q8"}],["path",{d:"M5 3H4a2 2 0 0 0-2 2v4a6 6 0 0 0 12 0V5a2 2 0 0 0-2-2h-1",key:"rb5t3r"}],["path",{d:"M8 15a6 6 0 0 0 12 0v-3",key:"x18d4x"}],["circle",{cx:"20",cy:"10",r:"2",key:"ts1r5v"}]]),b=i("ellipsis-vertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]),y=i("external-link",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]),f=function(){for(var e,s,t=0,a="",r=arguments.length;t<r;t++)(e=arguments[t])&&(s=function e(s){var t,a,r="";if("string"==typeof s||"number"==typeof s)r+=s;else if("object"==typeof s)if(Array.isArray(s)){var l=s.length;for(t=0;t<l;t++)s[t]&&(a=e(s[t]))&&(r&&(r+=" "),r+=a)}else for(a in s)s[a]&&(r&&(r+=" "),r+=a);return r}(e))&&(a&&(a+=" "),a+=s);return a};function j(){let[e,a]=(0,t.useState)(""),[r,l]=(0,t.useState)(!1),[n,i]=(0,t.useState)([]),[j,N]=(0,t.useState)(""),[w,k]=(0,t.useState)(null),[C,_]=(0,t.useState)({isChild:!1,isPregnant:!1,isLactating:!1,isRenal:!1}),M=async()=>{if(e.trim()){l(!0),N(""),i([]),k(null);try{let s=await fetch("/api/suggest",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({drugName:e,context:C})});if(!s.ok)throw Error("Failed to fetch suggestions");let t=await s.json();i(t.alternatives||[]),t.alternatives&&0===t.alternatives.length&&N("条件に合う代替薬が見つかりませんでした（供給停止または該当なし）")}catch(e){N("AIの呼び出しに失敗しました。しばらく待ってから再試行してください。"),console.error(e)}finally{l(!1)}}},A=(0,t.useRef)([]),R=(0,t.useRef)(null),S=()=>{R.current&&clearTimeout(R.current),R.current=setTimeout(()=>{k(null)},300)};return(0,s.jsxs)("main",{className:"min-h-screen bg-slate-50 text-slate-800 pb-20",children:[(0,s.jsx)("header",{className:"bg-emerald-600 text-white p-4 shadow-md sticky top-0 z-10",children:(0,s.jsx)("div",{className:"max-w-4xl mx-auto flex items-center justify-between",children:(0,s.jsxs)("h1",{className:"text-xl font-bold flex items-center gap-2",children:[(0,s.jsx)(m,{className:"w-6 h-6"})," 代替薬ナビゲーター ",(0,s.jsx)("span",{className:"text-xs font-normal bg-emerald-800 px-2 py-1 rounded",children:"Beta"})]})})}),(0,s.jsxs)("div",{className:"max-w-4xl mx-auto p-4 space-y-6",children:[(0,s.jsxs)("section",{className:"bg-white p-6 rounded-xl shadow-sm border border-slate-100 space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-slate-600 mb-1",children:"欠品・不足している薬剤名"}),(0,s.jsx)("input",{type:"text",value:e,onChange:e=>a(e.target.value),onKeyDown:e=>{"Enter"===e.key&&M()},placeholder:"例: アストミン錠10mg",className:"w-full text-lg p-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 outline-none transition"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[(0,s.jsx)(v,{active:C.isChild,onClick:()=>_({...C,isChild:!C.isChild}),icon:(0,s.jsx)(o,{className:"w-5 h-5"}),label:"小児"}),(0,s.jsx)(v,{active:C.isPregnant,onClick:()=>_({...C,isPregnant:!C.isPregnant}),icon:(0,s.jsx)(p,{className:"w-5 h-5"}),label:"妊婦"}),(0,s.jsx)(v,{active:C.isLactating,onClick:()=>_({...C,isLactating:!C.isLactating}),icon:(0,s.jsx)(h,{className:"w-5 h-5"}),label:"授乳婦"}),(0,s.jsx)(v,{active:C.isRenal,onClick:()=>_({...C,isRenal:!C.isRenal}),icon:(0,s.jsx)(x,{className:"w-5 h-5"}),label:"腎機能低下"})]}),(0,s.jsx)("button",{onClick:M,disabled:r||!e,className:"w-full bg-emerald-600 hover:bg-emerald-700 disabled:bg-slate-300 text-white font-bold py-4 rounded-lg shadow-sm transition flex items-center justify-center gap-2 text-lg",children:r?"AIが考え中...":(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c,{className:"w-5 h-5"})," 代替薬を探す"]})})]}),(0,s.jsx)("div",{className:"text-xs text-slate-500 px-2 leading-relaxed",children:"※ 以下の基準等を考慮して提案します: 添付文書, FDA基準, オーストラリア基準, 虎ノ門病院基準, 国立成育医療研究センター「授乳中に安全に使用できると思われる薬」, 母乳とくすりハンドブック等"}),j&&(0,s.jsxs)("div",{className:"bg-red-50 text-red-600 p-4 rounded-lg border border-red-100 flex items-center gap-2",children:[(0,s.jsx)(d,{className:"w-5 h-5"})," ",j]}),(0,s.jsx)("div",{className:"space-y-4",children:n.map((e,t)=>(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-visible relative animate-in fade-in slide-in-from-bottom-4 duration-500",style:{animationDelay:`${50*t}ms`,zIndex:w===t?20:1},children:[(0,s.jsxs)("div",{className:"bg-slate-50 p-3 border-b border-slate-100 flex justify-between items-center relative",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 flex-grow",children:[(0,s.jsx)("span",{className:"bg-emerald-100 text-emerald-700 w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold flex-shrink-0",children:t+1}),(0,s.jsxs)("div",{className:"relative group cursor-pointer inline-block",onMouseLeave:S,children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("h2",{className:"font-bold text-lg text-emerald-900 flex items-center gap-2 hover:text-emerald-700 transition-colors",onMouseEnter:()=>{R.current&&(clearTimeout(R.current),R.current=null),k(t)},children:[e.drug_name,(0,s.jsx)(b,{className:"w-4 h-4 text-slate-400 opacity-0 group-hover:opacity-100 transition-opacity"})]}),e.shipment_status&&(0,s.jsx)("span",{className:f("text-xs px-2 py-0.5 rounded-full border inline-block",e.shipment_status.includes("通常")?"bg-blue-100 text-blue-800 border-blue-200":e.shipment_status.includes("限定")?"bg-yellow-100 text-yellow-800 border-yellow-200":e.shipment_status.includes("停止")?"bg-gray-100 text-gray-800 border-gray-200":"bg-slate-100 text-slate-600 border-slate-200"),children:e.shipment_status})]}),w===t&&(0,s.jsx)("div",{ref:e=>{A.current[t]=e},className:"absolute left-8 top-10 bg-white border border-slate-200 shadow-xl rounded-lg w-56 z-50 animate-in fade-in zoom-in-95 duration-100",children:(0,s.jsxs)("ul",{className:"py-1 text-sm text-slate-700",children:[(0,s.jsx)("li",{children:(0,s.jsxs)("a",{href:`../search.html?drugName=${encodeURIComponent(e.drug_name)}`,target:"_blank",rel:"noopener noreferrer",className:"block px-4 py-2 hover:bg-slate-50 flex items-center gap-2",children:[(0,s.jsx)(y,{className:"w-3 h-3"})," 医薬品出荷状況検索"]})}),(0,s.jsx)("li",{children:(0,s.jsxs)("a",{href:e.yj_code?`https://www.pmda.go.jp/PmdaSearch/rdSearch/02/${e.yj_code}?user=1`:`https://www.google.com/search?q=${encodeURIComponent(e.drug_name+" 添付文書")}`,target:"_blank",rel:"noopener noreferrer",className:"block px-4 py-2 hover:bg-slate-50 flex items-center gap-2",children:[(0,s.jsx)(y,{className:"w-3 h-3"})," 医薬品情報 (PMDA)"]})}),(0,s.jsx)("li",{children:(0,s.jsxs)("a",{href:`../hiyari_app/index.html?drugName=${encodeURIComponent(e.drug_name)}`,target:"_blank",rel:"noopener noreferrer",className:"block px-4 py-2 hover:bg-slate-50 flex items-center gap-2",children:[(0,s.jsx)(y,{className:"w-3 h-3"})," ヒヤリハット検索"]})}),(0,s.jsx)("li",{children:(0,s.jsxs)("a",{href:`../update/index.html?productName=${encodeURIComponent(e.drug_name)}&shippingStatus=all&updateDate=all`,target:"_blank",rel:"noopener noreferrer",className:"block px-4 py-2 hover:bg-slate-50 flex items-center gap-2",children:[(0,s.jsx)(y,{className:"w-3 h-3"})," 情報更新日"]})})]})})]})]}),(0,s.jsx)("div",{className:"text-xs font-mono bg-slate-200 px-2 py-1 rounded text-slate-600 ml-2 whitespace-nowrap hidden md:block",children:"AI提案"})]}),(0,s.jsxs)("div",{className:"p-4 space-y-4",children:[(0,s.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsxs)("p",{className:"text-xs font-bold text-slate-400 uppercase",children:["特徴・機序 ",e.general_name&&(0,s.jsxs)("span",{className:"font-normal text-slate-500",children:["(",e.general_name,")"]})]}),(0,s.jsx)("p",{className:"text-sm text-slate-700",children:e.mechanism})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("p",{className:"text-xs font-bold text-slate-400 uppercase",children:"安全性評価 (コンテキスト)"}),(0,s.jsxs)("p",{className:"text-sm font-semibold text-slate-800 bg-orange-50 p-2 rounded border border-orange-100 flex items-start gap-2",children:[(0,s.jsx)(g,{className:"w-4 h-4 text-orange-500 mt-0.5 shrink-0"}),e.safety_assessment]})]})]}),(0,s.jsxs)("div",{className:"grid md:grid-cols-2 gap-4 pt-2 border-t border-slate-100",children:[(0,s.jsxs)("div",{className:"bg-blue-50 p-3 rounded-lg border border-blue-100",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-blue-800 font-bold text-sm mb-2",children:[(0,s.jsx)(u,{className:"w-4 h-4"})," 医師への提案ロジック"]}),(0,s.jsx)("p",{className:"text-sm text-slate-700 leading-relaxed",children:e.doctor_explanation})]}),(0,s.jsxs)("div",{className:"bg-green-50 p-3 rounded-lg border border-green-100",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-green-800 font-bold text-sm mb-2",children:[(0,s.jsx)(p,{className:"w-4 h-4"})," 患者さんへの説明"]}),(0,s.jsx)("p",{className:"text-sm text-slate-700 leading-relaxed",children:e.patient_explanation})]})]})]})]},t))})]})]})}function v({active:e,onClick:t,icon:a,label:r}){return(0,s.jsxs)("button",{onClick:t,className:f("flex items-center justify-center gap-2 p-3 rounded-lg border transition-all duration-200",e?"bg-emerald-100 border-emerald-500 text-emerald-800 shadow-inner font-bold":"bg-white border-slate-200 text-slate-500 hover:bg-slate-50"),children:[a,(0,s.jsx)("span",{className:"text-sm",children:r})]})}e.s(["default",()=>j],52683)}]);