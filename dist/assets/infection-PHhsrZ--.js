import"./modulepreload-polyfill-B5Qt9EMX.js";/* empty css              */function N(t){if(!t||t.querySelector(".chart-loading-overlay"))return;const e=document.createElement("div");e.className="chart-loading-overlay",e.innerHTML='<div class="chart-loading-skeleton"></div>',window.getComputedStyle(t).position==="static"&&t.classList.add("position-relative"),t.appendChild(e)}function b(t){if(!t)return;const e=t.querySelector(".chart-loading-overlay");e&&e.remove()}console.log("infection app main.js loaded");const G="https://script.google.com/macros/s/AKfycby8wh0NMuPtEOgLVHXfc0jzNqlOENuOgCwQmYYzMSZCKTvhSDiJpZkAyJxntGISTGOmbQ/exec";let d={current:null,archives:[]},L="Influenza";const O=[{key:"Influenza",name:"インフルエンザ"},{key:"COVID-19",name:"COVID-19"},{key:"ARI",name:"急性呼吸器感染症"},{key:"RSV",name:"ＲＳウイルス感染症"},{key:"PharyngoconjunctivalFever",name:"咽頭結膜熱"},{key:"AGS_Pharyngitis",name:"Ａ群溶血性レンサ球菌咽頭炎"},{key:"InfectiousGastroenteritis",name:"感染性胃腸炎"},{key:"Chickenpox",name:"水痘"},{key:"HandFootMouthDisease",name:"手足口病"},{key:"ErythemaInfectiosum",name:"伝染性紅斑"},{key:"ExanthemSubitum",name:"突発性発しん"},{key:"Herpangina",name:"ヘルパンギーナ"},{key:"Mumps",name:"流行性耳下腺炎"},{key:"AcuteHemorrhagicConjunctivitis",name:"急性出血性結膜炎"},{key:"EpidemicKeratoconjunctivitis",name:"流行性角結膜炎"},{key:"BacterialMeningitis",name:"細菌性髄膜炎"},{key:"AsepticMeningitis",name:"無菌性髄膜炎"},{key:"MycoplasmaPneumonia",name:"マイコプラズマ肺炎"},{key:"ChlamydiaPneumonia",name:"クラミジア肺炎"},{key:"RotavirusGastroenteritis",name:"感染性胃腸炎（ロタウイルス）"}];let A=null,y=null;window.setCurrentRegion=function(t){A=t,y=null};const k={CURRENT_DATA_KEY:"infection_surveillance_current_data_v1",ARCHIVE_DATA_KEY:"infection_surveillance_archive_data_v1",MAIN_EXPIRY:3600*1e3,HISTORY_EXPIRY:1440*60*1e3};async function Z(){const t=Date.now();try{const e=await localforage.getItem(k.CURRENT_DATA_KEY);if(e&&t-e.timestamp<k.MAIN_EXPIRY)return e.data}catch(e){console.warn("Current data cache check failed:",e)}try{const e=await fetch(`${G}?type=current`,{redirect:"follow"});if(!e.ok)throw new Error(`HTTP Error: ${e.status} ${e.statusText}`);const n=await e.json();if(n&&n.status==="error")throw new Error(`API Error: ${n.message}`);try{await localforage.setItem(k.CURRENT_DATA_KEY,{timestamp:t,data:n})}catch(o){console.warn("Current data cache save failed:",o)}return n}catch(e){throw console.error("Fetch error for current data:",e),e}}async function K(){const t=Date.now();try{const e=await localforage.getItem(k.ARCHIVE_DATA_KEY);if(e&&t-e.timestamp<k.HISTORY_EXPIRY)return e.data}catch(e){console.warn("Archive data cache check failed:",e)}try{const e=await fetch(`${G}?type=history`,{redirect:"follow"});if(!e.ok)throw new Error(`HTTP Error: ${e.status} ${e.statusText}`);const n=await e.json();try{await localforage.setItem(k.ARCHIVE_DATA_KEY,{timestamp:t,data:n})}catch(o){console.warn("Archive data cache save failed:",o)}return n}catch(e){throw console.error("Fetch error for archive data:",e),e}}function Q(t){const e=document.getElementById("summary-cards");if(!e)return;for(;e.firstChild;)e.removeChild(e.firstChild);O.filter(o=>["Influenza","COVID-19","ARI"].includes(o.key)).forEach(o=>{const l=o.key,i=t.current.data.find(u=>u.disease===l&&u.prefecture==="全国"),a=t.current.summary.alerts.find(u=>u.disease===l),r=document.createElement("div");r.className=`card ${L===l?"active":""}`,r.dataset.disease=l,r.dataset.status=a?a.level:"normal",r.onclick=()=>ee(l);const c=document.createElement("h4");c.textContent=$(l),r.appendChild(c);const s=document.createElement("p");s.className="value",s.textContent=`${i?i.value.toFixed(2):"-"}`;const p=document.createElement("span");p.className="unit",p.textContent=" 定点当たり",s.appendChild(p),r.appendChild(s);const m=document.createElement("p");m.className=`status ${a?a.level:"normal"}`,m.textContent=a?a.message:"データなし",r.appendChild(m),e.appendChild(r)})}function ee(t){L=t,document.querySelectorAll(".summary-cards .card").forEach(o=>{o.classList.toggle("active",o.dataset.disease===t)});const e=document.getElementById("other-diseases-list-view");if(e&&!e.classList.contains("hidden")?V(y||"全国"):y?Y(y,t):F("main-view"),!y)A&&typeof window.updateDetailPanel=="function"&&d?window.updateDetailPanel(A,d,t,y):T();else if(typeof window.getRegionIdByPrefecture=="function"&&typeof window.updateDetailPanel=="function"&&d){const o=window.getRegionIdByPrefecture(y);o?window.updateDetailPanel(o,d,t,y):T()}else T();d&&U(t,d)}function $(t){const e=O.find(n=>n.key===t);return e?e.name:t}let R=null;function z(t){let e=0;return d.current&&d.current.history&&d.current.history.forEach(n=>{n.disease===t&&n.history.forEach(o=>{o.value>e&&(e=o.value)})}),d.archives&&d.archives.forEach(n=>{n.data&&n.data.forEach(o=>{o.disease===t&&o.history.forEach(l=>{l.value>e&&(e=l.value)})})}),e}function W(t,e,n,o,l=null,i){i&&N(i);const a=document.getElementById(t);if(!a){console.warn(`Canvas element with ID '${t}' not found.`),i&&(b(i),i.innerHTML='<p class="no-data-message">グラフを描画できませんでした。</p>');return}const r=a.getContext("2d");a.chart&&a.chart.destroy(),r&&r.clearRect(0,0,a.width,a.height);const c=window.innerWidth<=768,s=Array.from({length:53},(C,w)=>`${w+1}週`),p=C=>{const w=C.year;let v,D,B=1;if(w===new Date().getFullYear()){const g=C.data.filter(f=>f&&f.value!==null&&f.value!==void 0),I=g.length>0?g[g.length-1]:{value:0};v=getColorForValue(I.value,e),D=3,B=2.5}else w===new Date().getFullYear()-1?(v="#A9CCE3",D=2):(v="#E0E0E0",D=1);t.startsWith("chart-")&&(B=0);const E={label:`${w}年`,data:s.map(g=>{const I=parseInt(g),f=C.data.find(M=>M.week===I);return f?f.value:null}),borderColor:v,borderWidth:D,pointRadius:B,fill:!1,tension:.1,spanGaps:!0,_originalColor:v,_originalBorderWidth:D,disease:e,year:w};return w===new Date().getFullYear()&&(E.segment={borderColor:g=>{if(!g.p1||!g.p1.parsed)return v;const I=g.p1.parsed.y;return typeof getColorForValue=="function"?getColorForValue(I,e):v}},E.pointBackgroundColor=g=>{const I=g.parsed.y;return typeof getColorForValue=="function"?getColorForValue(I,e):v},E.pointBorderColor=g=>{const I=g.parsed.y;return typeof getColorForValue=="function"?getColorForValue(I,e):v}),E};new Date().getFullYear();const u=o.sort((C,w)=>w.year-C.year).map(p),h={type:"line",data:{labels:s,datasets:u},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,title:{display:!0,text:"定点当たり報告数"},suggestedMax:l},x:{title:{display:!0,text:"週"},ticks:{maxRotation:0,autoSkip:!0,autoSkipPadding:10}}},interaction:{intersect:!1,mode:"index",axis:"x"},elements:{point:{hitRadius:20,hoverRadius:4},line:{borderCapStyle:"round",borderJoinStyle:"round"}},plugins:{title:{display:!1,text:`${n} ${$(e)} 週次推移`,font:{size:16,family:"'Noto Sans JP', sans-serif"}},tooltip:{enabled:!c,mode:"index",intersect:!1,position:"nearest",bodyFont:{size:c?14:13},titleFont:{size:c?14:13},padding:10,boxPadding:4,backgroundColor:"rgba(0, 0, 0, 0.8)",titleColor:"#fff",bodyColor:"#fff",footerColor:"#fff"},legend:{display:!0,position:"bottom",labels:{boxWidth:10,padding:10,font:{size:c?11:12},usePointStyle:!0,pointStyle:"rectRounded"},onClick:function(C,w,v){C.native&&C.native.stopPropagation();const D=w.datasetIndex,B=v.chart,_=B.data.datasets,E=_[D];E._originalColor||(E._originalColor=E.borderColor,E._originalBorderWidth=E.borderWidth);const g=E.borderColor===E._originalColor,I=_.some((f,M)=>M!==D&&f.borderColor==="rgba(200, 200, 200, 0.2)");g&&I?_.forEach(f=>{f.borderColor=f._originalColor,f.borderWidth=f._originalBorderWidth}):_.forEach((f,M)=>{M!==D?(f.borderColor="rgba(200, 200, 200, 0.2)",f.borderWidth=1):(f.borderColor=f._originalColor,f.borderWidth=3)}),B.update()}}},animation:{duration:0}}},x=()=>{a.chart&&a.chart.destroy(),a.chart=new Chart(r,h),i&&b(i)},P=i||a.parentElement;if(P&&typeof ResizeObserver<"u"){const C=new ResizeObserver(w=>{const v=w[0];v.contentRect.width>0&&v.contentRect.height>0&&(C.disconnect(),x())});C.observe(P)}else setTimeout(x,50)}function U(t,e){const n=document.getElementById("chart-view");n&&N(n),te(t,e.current),n&&b(n),typeof renderJapanMap=="function"&&document.getElementById("japan-map")&&requestAnimationFrame(()=>{renderJapanMap("japan-map",e.current,t)})}function te(t,e){const n=document.getElementById("chart-view");if(!n)return;for(N(n);n.firstChild;)n.removeChild(n.firstChild);const o=document.createElement("canvas");o.id="trendChart",n.appendChild(o);const l=o.getContext("2d");R&&R.destroy();const i=e.data.filter(s=>s.disease===t&&s.prefecture!=="全国").sort((s,p)=>p.value-s.value).slice(0,10),a=i.map(s=>s.prefecture),r=i.map(s=>s.value),c=r.map(s=>typeof getColorForValue=="function"?getColorForValue(s,t):"#3498db");if(a.length===0){b(n);const s=document.createElement("p");s.className="no-data-message",s.textContent="データがありません。",n.appendChild(s);return}R=new Chart(l,{type:"bar",data:{labels:a,datasets:[{label:"定点当たり報告数",data:r,backgroundColor:c,borderColor:c,borderWidth:1}]},options:{indexAxis:"y",responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},title:{display:!0,text:`${$(t)} 都道府県別 報告数 Top 10`,font:{size:14,family:"'Noto Sans JP', sans-serif"}}},scales:{x:{beginAtZero:!0,title:{display:!0,text:"定点当たり報告数"}},y:{ticks:{autoSkip:!1}}}}}),b(n)}function J(t,e){const n=[],o=new Date().getFullYear(),l=new Set;if(d.current&&d.current.history){const i=d.current.history.find(a=>a.disease===t&&a.prefecture===e);i&&(n.push({year:o,data:i.history}),l.add(o))}return d.archives&&d.archives.length>0?d.archives.forEach(i=>{const a=parseInt(i.year);if(l.has(a))return;const r=i.data?i.data.find(c=>c.disease===t&&c.prefecture===e):null;r&&(n.push({year:i.year,data:r.history}),l.add(a))}):console.log("No archives available yet for yearDataSets."),n}function ne(t,e){H();const n=document.createElement("div");n.className="disease-card expanded expanded-modal modal-expanded",n.dataset.disease=t;const o=document.createElement("div");o.className="card-header";const l=document.createElement("h4");l.textContent=`${e} ${$(t)}`,o.appendChild(l);const i=document.createElement("button");i.className="close-expanded-btn modal-close-button",i.textContent="×",i.setAttribute("aria-label","閉じる"),i.onclick=H,n.appendChild(i),n.appendChild(o);const a=document.createElement("div");a.className="chart-container";const r=`expanded-chart-${t}`,c=document.createElement("canvas");c.id=r,a.appendChild(c),n.appendChild(a),document.body.appendChild(n);const s=document.getElementById("card-backdrop");if(s){s.classList.add("active");const u=()=>{H(),s.removeEventListener("click",u)};s.addEventListener("click",u)}const p=J(t,e),m=z(t);requestAnimationFrame(()=>{W(r,t,e,p,m,a)})}function H(){const t=document.querySelector(".disease-card.expanded-modal");if(t){const n=t.querySelector("canvas");n&&n.chart&&n.chart.destroy(),t.remove()}const e=document.getElementById("card-backdrop");e&&e.classList.remove("active")}function Y(t,e){y=t,A=null,document.getElementById("map-view").classList.add("hidden");const n=document.getElementById("pref-chart-container");n.classList.remove("hidden"),n.innerHTML="";const o=document.createElement("div");o.classList.add("pref-chart-header");const l=document.createElement("h3");l.textContent=`${t} ${$(e)}`,l.classList.add("pref-chart-title"),o.appendChild(l);const i=document.createElement("button");if(i.id="back-to-map-btn",i.textContent="戻る",o.appendChild(i),n.appendChild(o),i.addEventListener("click",()=>{document.getElementById("map-view").classList.remove("hidden"),document.getElementById("pref-chart-container").classList.add("hidden"),y=null,A&&typeof window.updateDetailPanel=="function"&&d&&window.updateDetailPanel(A,d,L,null)}),typeof window.getRegionIdByPrefecture=="function"&&typeof window.updateDetailPanel=="function"&&d){const r=window.getRegionIdByPrefecture(t);r&&window.updateDetailPanel(r,d,e,t)}if(e==="ARI"){const r=document.createElement("div");r.className="pref-chart-wrapper pref-chart-message-wrapper",n.appendChild(r);const c=document.createElement("p");c.className="pref-chart-message",c.textContent="急性呼吸器感染症 (ARI) の週次推移データはありません。",r.appendChild(c);return}const a=document.createElement("div");if(a.className="pref-chart-wrapper",n.appendChild(a),N(a),e==="ARI"){b(a);const r=document.createElement("p");r.className="pref-chart-message",r.textContent="急性呼吸器感染症 (ARI) の週次推移データはありません。",a.appendChild(r)}else{const r=document.createElement("canvas");r.id="prefectureHistoryChart",a.appendChild(r);const c=[],s=new Date().getFullYear(),p=d.current.history.find(u=>u.disease===e&&u.prefecture===t);p&&c.push({year:s,data:p.history}),d.archives&&d.archives.forEach(u=>{if(parseInt(u.year)===s)return;const h=u.data.find(x=>x.disease===e&&x.prefecture===t);h&&c.push({year:u.year,data:h.history})});const m=d.isLoadingArchives;if(c.length===0&&!m){console.warn(`No history data for ${t} (${e}) across all years.`),b(a);const u=document.createElement("p");u.classList.add("no-data-message-inline"),u.textContent="データがありません。",a.innerHTML="",a.appendChild(u)}else{const u=z(e);if(W("prefectureHistoryChart",e,t,c,u,a),m){const h=document.createElement("div");h.className="archive-loading-indicator",h.textContent="過去のデータを読み込み中...",h.style.position="absolute",h.style.top="10px",h.style.right="10px",h.style.backgroundColor="rgba(255, 255, 255, 0.8)",h.style.padding="4px 8px",h.style.borderRadius="4px",h.style.fontSize="12px",h.style.color="#666",h.style.zIndex="10",a.style.position="relative",a.appendChild(h),b(a)}else b(a)}}}window.showPrefectureChart=Y;function F(t){console.log("DEBUG: switchView called with viewId:",t),["main-view","other-diseases-list-view"].forEach(n=>{const o=document.getElementById(n);o&&(n===t?(o.classList.remove("hidden"),console.log(`DEBUG: Removed hidden from ${n}`)):(o.classList.add("hidden"),console.log(`DEBUG: Added hidden to ${n}`)))})}function V(t="全国"){const e=document.getElementById("other-diseases-grid");if(!e)return;for(;e.firstChild;)e.removeChild(e.firstChild);const n=document.getElementById("other-diseases-title");n&&(n.textContent=`その他の感染症（${t}）`);const o=document.getElementById("prefecture-select");o&&(o.value=t);const l=O.filter(a=>!["Influenza","COVID-19","ARI"].includes(a.key)),i=[];l.forEach(a=>{const r=document.createElement("div");r.className="disease-card",r.dataset.disease=a.key;const c=document.createElement("div");c.className="card-header";const s=document.createElement("h4");s.textContent=a.name;const p=document.createElement("button");p.className="expand-action-btn",p.setAttribute("aria-label","拡大表示"),p.innerHTML="";const m=document.createElementNS("http://www.w3.org/2000/svg","svg");m.setAttribute("xmlns","http://www.w3.org/2000/svg"),m.setAttribute("width","20"),m.setAttribute("height","20"),m.setAttribute("viewBox","0 0 24 24"),m.setAttribute("fill","none"),m.setAttribute("stroke","currentColor"),m.setAttribute("stroke-width","2"),m.setAttribute("stroke-linecap","round"),m.setAttribute("stroke-linejoin","round");const u=document.createElementNS("http://www.w3.org/2000/svg","path");u.setAttribute("d","M12 5v14M5 12h14"),m.appendChild(u),p.appendChild(m),c.appendChild(s),c.appendChild(p),r.appendChild(c);const h=document.createElement("div");h.className="chart-container";const x=document.createElement("canvas");x.id=`chart-${a.key}`,h.appendChild(x),r.appendChild(h),e.appendChild(r),N(h);const P=r.querySelector(".expand-action-btn");P&&P.addEventListener("click",C=>{C.stopPropagation(),ne(a.key,t)}),i.push({disease:a,chartContainer:h,canvas:x})}),requestAnimationFrame(()=>{let a=0;function r(){if(a>=i.length)return;const{disease:c,chartContainer:s,canvas:p}=i[a],m=J(c.key,t);if(m.length>0){const u=z(c.key);W(`chart-${c.key}`,c.key,t,m,u,s)}else{b(s);const u=document.createElement("p");for(u.textContent="データがありません";s.firstChild;)s.removeChild(s.firstChild);s.appendChild(u),s.classList.add("chart-container-no-data")}a++,a<i.length&&setTimeout(r,0)}r()})}function T(){const t=document.getElementById("region-content");if(t){const n=document.createElement("p");n.className="placeholder-text",n.textContent="地図上のエリアをクリックすると詳細が表示されます。",t.replaceChildren(n)}const e=document.getElementById("region-title");e&&(e.textContent="地域詳細")}function S(t){const e=document.body;t?e.classList.add("loading"):e.classList.remove("loading")}async function ae(){try{S(!0),R&&(R.destroy(),R=null);const t=document.getElementById("prefectureHistoryChart");t&&t.chart&&t.chart.destroy();const e=document.getElementById("summary-cards");if(e){e.innerHTML="";const a=document.createElement("div");a.className="skeleton-card-wrapper";for(let r=0;r<5;r++){const c=document.createElement("div");c.className="skeleton-card",c.innerHTML='<div class="skeleton skeleton-title"></div><div class="skeleton skeleton-value"></div><div class="skeleton skeleton-status"></div>',a.appendChild(c)}e.appendChild(a)}const n=document.getElementById("japan-map");if(n){n.innerHTML="";const a=document.createElement("div");a.className="skeleton skeleton-map",n.appendChild(a)}const o=document.getElementById("chart-view");o&&(o.innerHTML="",N(o));const l=document.getElementById("region-content");if(l&&A){l.innerHTML="";const a=document.createElement("div");a.className="skeleton skeleton-chart large",l.appendChild(a)}await localforage.removeItem(k.CURRENT_DATA_KEY),await localforage.removeItem(k.ARCHIVE_DATA_KEY),console.log("Cache cleared for infection data reload."),await X(),A&&typeof window.updateDetailPanel=="function"&&d&&window.updateDetailPanel(A,d,L,y),y&&Y(y,L);const i=document.getElementById("other-diseases-list-view");if(i&&!i.classList.contains("hidden")){const a=document.getElementById("prefecture-select");V(a?a.value:"全国")}}catch(t){console.error("Error reloading data:",t);const e=document.getElementById("summary-cards");if(e){for(;e.firstChild;)e.removeChild(e.firstChild);const n=document.createElement("p");n.className="error",n.textContent=`データの再取得に失敗しました。詳細: ${t.message}`,e.appendChild(n)}}finally{S(!1)}}function oe(){const t=document.getElementById("accordion-toggle"),e=document.getElementById("accordion-content");t&&e&&t.addEventListener("click",()=>{e.classList.toggle("open"),t.classList.toggle("open")});const n=document.getElementById("reload-btn");n&&n.addEventListener("click",ae);const o=document.getElementById("detail-panel-close-btn");o&&o.addEventListener("click",T);const l=document.getElementById("card-backdrop");l&&l.addEventListener("click",()=>{document.querySelector(".disease-card.expanded-modal")&&H();const r=document.querySelector(".disease-card.expanded:not(.expanded-modal)");r&&(r.classList.remove("expanded"),l.classList.remove("active"))});const i=document.getElementById("back-to-map-btn");i&&i.addEventListener("click",()=>{document.getElementById("map-view").classList.remove("hidden"),document.getElementById("pref-chart-container").classList.add("hidden"),y=null});const a=document.getElementById("other-diseases-btn");a&&a.addEventListener("click",()=>{const r=document.getElementById("other-diseases-list-view");r&&!r.classList.contains("hidden")?(a.textContent="その他の感染症",document.getElementById("summary-cards").classList.remove("hidden"),F("main-view")):(a.textContent="インフルエンザ・COVID-19",document.getElementById("summary-cards").classList.add("hidden"),F("other-diseases-list-view"),V(y||"全国"));const s=document.getElementById("prefecture-select");s&&s.options.length<=1&&(["北海道","青森県","岩手県","宮城県","秋田県","山形県","福島県","茨城県","栃木県","群馬県","埼玉県","千葉県","東京都","神奈川県","新潟県","富山県","石川県","福井県","山梨県","長野県","岐阜県","静岡県","愛知県","三重県","滋賀県","京都府","大阪府","兵庫県","奈良県","和歌山県","鳥取県","島根県","岡山県","広島県","山口県","徳島県","香川県","愛媛県","高知県","福岡県","佐賀県","長崎県","熊本県","大分県","宮崎県","鹿児島県","沖縄県"].forEach(m=>{const u=document.createElement("option");u.value=m,u.textContent=m,s.appendChild(u)}),y&&(s.value=y),s.addEventListener("change",m=>{V(m.target.value)}))})}async function X(){try{const t=Date.now();let e=null;try{const n=await localforage.getItem(k.CURRENT_DATA_KEY);n&&t-n.timestamp<k.MAIN_EXPIRY&&(e=n.data)}catch(n){console.warn("Current data cache check failed:",n)}e||(e=await Z()),d.current=e,d.current&&d.current.meta&&d.current.meta.dateInfo?q(d.current.meta.dateInfo):q(""),Q(d),U(L,d),S(!1),d.isLoadingArchives=!0,K().then(n=>{console.log("Archives loaded in background:",n.length,"years"),d.archives=n,d.isLoadingArchives=!1,j()}).catch(n=>{console.warn("Background archive fetch failed:",n),d.isLoadingArchives=!1,j()})}catch(t){throw console.error("Error in loadAndRenderData:",t),t}}function j(){y&&Y(y,L);const t=document.getElementById("other-diseases-list-view");if(t&&!t.classList.contains("hidden")){const e=document.getElementById("prefecture-select");V(e?e.value:"全国")}}function q(t){const e=document.getElementById("update-date");if(!e)return;const n=t.match(/(\d{4})年(\d{1,2})週(?:\((.*?)\))?/);if(n){const o=n[1],l=n[2];let i=n[3];i?(i=i.replace(/月/g,"/").replace(/日/g,"").replace(/[〜~]/g,"～"),e.textContent=`${o}年 第${l}週 （${i}）`):e.textContent=`${o}年 第${l}週`}else e.textContent=new Date().toLocaleDateString("ja-JP")}async function re(){try{S(!0),oe(),console.log("DEBUG: initEventListeners called"),await X(),S(!1)}catch(t){console.error("Error fetching data:",t);const e=document.getElementById("summary-cards");if(e){for(;e.firstChild;)e.removeChild(e.firstChild);const n=document.createElement("p");n.className="error",n.textContent=`データの取得に失敗しました。詳細: ${t.message}`,e.appendChild(n)}S(!1)}}document.addEventListener("DOMContentLoaded",re);
