import"./modulepreload-polyfill-B5Qt9EMX.js";/* empty css              *//* empty css              */import{l as Y,f as O,c as F}from"./data-BguHeUhv.js";import{n as E}from"./utils-cz7vvGbo.js";import{u as T,s as h,c as R,r as M}from"./ui-C1FH7vrA.js";import{a as J}from"./typing-animation-B3fvp7eE.js";let j=[],L={},y={status:"asc",productName:"asc",ingredientName:"asc",yjCode:"asc"};const e={mainHeader:null,mainFooter:null,yjCodeInput:null,searchBtn:null,shareBtn:null,resultTableBody:null,resultCardContainer:null,loadingIndicator:null,tableContainer:null,cardContainer:null,reloadDataBtn:null,checkboxes:{class3:null,class4:null,ingredient:null,form:null,standard:null,brand:null},statusCheckboxes:{normal:null,limited:null,stopped:null},sortButtons:{status:null,productName:null,ingredientName:null,yjCode:null},sortIcons:{status:null,productName:null,ingredientName:null,yjCode:null}};function H(){e.mainHeader=document.getElementById("mainHeader"),e.mainFooter=document.getElementById("mainFooter"),e.yjCodeInput=document.getElementById("yjCodeInput"),e.searchBtn=document.getElementById("search-btn"),e.shareBtn=document.getElementById("share-btn"),e.resultTableBody=document.getElementById("resultTableBody"),e.resultCardContainer=document.getElementById("resultCardContainer"),e.loadingIndicator=document.getElementById("loadingIndicator"),e.tableContainer=document.getElementById("tableContainer"),e.cardContainer=document.getElementById("cardContainer"),e.resultCardContainer=e.cardContainer,e.reloadDataBtn=document.getElementById("reload-data"),e.checkboxes.class3=document.getElementById("filter-class3"),e.checkboxes.class4=document.getElementById("filter-class4"),e.checkboxes.ingredient=document.getElementById("filter-ingredient"),e.checkboxes.form=document.getElementById("filter-form"),e.checkboxes.standard=document.getElementById("filter-standard"),e.checkboxes.brand=document.getElementById("filter-brand"),e.statusCheckboxes.normal=document.getElementById("statusNormal"),e.statusCheckboxes.limited=document.getElementById("statusLimited"),e.statusCheckboxes.stopped=document.getElementById("statusStop"),e.sortButtons.status=document.getElementById("sort-status-button"),e.sortButtons.productName=document.getElementById("sort-productName-button"),e.sortButtons.ingredientName=document.getElementById("sort-ingredientName-button"),e.sortButtons.yjCode=document.getElementById("sort-yjCode-button"),e.sortIcons.status=document.getElementById("sort-status-icon"),e.sortIcons.productName=document.getElementById("sort-productName-icon"),e.sortIcons.ingredientName=document.getElementById("sort-ingredientName-icon"),e.sortIcons.yjCode=document.getElementById("sort-yjCode-icon")}async function W(){H();try{const[s,a]=await Promise.all([Y(T),O()]);s&&s.data?(j=s.data,console.log(`Loaded ${j.length} items for YJ search.`),h(`データ(${s.date}) ${j.length} 件を読み込みました。`,"success")):console.error("No data received from loadAndCacheData"),L=a||{};const u=new URLSearchParams(window.location.search),r=u.get("yj")||u.get("yjcode"),t=u.get("mode");if(u.has("yj"))z(u),N();else if(r){e.yjCodeInput.value=r;const l=t==="alternative";t==="ingredient"?(e.checkboxes.class3&&(e.checkboxes.class3.checked=!1),e.checkboxes.class4&&(e.checkboxes.class4.checked=!1),e.checkboxes.form&&(e.checkboxes.form.checked=!1),e.checkboxes.ingredient&&(e.checkboxes.ingredient.checked=!0),e.checkboxes.standard&&(e.checkboxes.standard.checked=!1),e.checkboxes.brand&&(e.checkboxes.brand.checked=!1),e.statusCheckboxes.normal&&(e.statusCheckboxes.normal.checked=!0),e.statusCheckboxes.limited&&(e.statusCheckboxes.limited.checked=!0),e.statusCheckboxes.stopped&&(e.statusCheckboxes.stopped.checked=!0)):(e.checkboxes.class3&&(e.checkboxes.class3.checked=!0),e.checkboxes.class4&&(e.checkboxes.class4.checked=!0),e.checkboxes.form&&(e.checkboxes.form.checked=!0),e.checkboxes.ingredient&&(e.checkboxes.ingredient.checked=l),e.checkboxes.standard&&(e.checkboxes.standard.checked=!1),e.checkboxes.brand&&(e.checkboxes.brand.checked=!1),e.statusCheckboxes.normal&&(e.statusCheckboxes.normal.checked=!0),e.statusCheckboxes.limited&&(e.statusCheckboxes.limited.checked=l),e.statusCheckboxes.stopped&&(e.statusCheckboxes.stopped.checked=l)),N()}}catch(s){console.error(s),h("データの読み込みに失敗しました。","error")}e.searchBtn.addEventListener("click",()=>N()),e.shareBtn&&e.shareBtn.addEventListener("click",()=>G()),e.reloadDataBtn&&e.reloadDataBtn.addEventListener("click",async()=>{if(!e.reloadDataBtn.disabled){e.reloadDataBtn.disabled=!0,e.reloadDataBtn.classList.add("opacity-50","cursor-not-allowed"),h("最新データを取得しています...","info");try{const s=await F(T);s&&s.data&&(j=s.data,h(`データを更新しました: ${j.length}件`,"success"),N())}catch(s){console.error("Reload failed:",s),h(`データの更新に失敗しました: ${s.message||"不明なエラー"}`,"error")}finally{e.reloadDataBtn.disabled=!1,e.reloadDataBtn.classList.remove("opacity-50","cursor-not-allowed")}}}),e.yjCodeInput.addEventListener("keypress",s=>{s.key==="Enter"&&N()}),Object.values(e.checkboxes).forEach(s=>{s&&s.addEventListener("change",()=>N())}),Object.values(e.statusCheckboxes).forEach(s=>{s&&s.addEventListener("change",()=>N())}),e.sortButtons.productName&&e.sortButtons.productName.addEventListener("click",()=>w("productName")),e.sortButtons.ingredientName&&e.sortButtons.ingredientName.addEventListener("click",()=>w("ingredientName")),e.sortButtons.status&&e.sortButtons.status.addEventListener("click",()=>w("status")),e.sortButtons.yjCode&&e.sortButtons.yjCode.addEventListener("click",()=>w("yjCode"))}function z(s){const a=s.get("yj");a&&e.yjCodeInput&&(e.yjCodeInput.value=a),e.checkboxes.class3&&(e.checkboxes.class3.checked=s.get("class3")==="1"),e.checkboxes.class4&&(e.checkboxes.class4.checked=s.get("class4")==="1"),e.checkboxes.ingredient&&(e.checkboxes.ingredient.checked=s.get("ingredient")==="1"),e.checkboxes.form&&(e.checkboxes.form.checked=s.get("form")==="1"),e.checkboxes.standard&&(e.checkboxes.standard.checked=s.get("standard")==="1"),e.checkboxes.brand&&(e.checkboxes.brand.checked=s.get("brand")==="1"),e.statusCheckboxes.normal&&(e.statusCheckboxes.normal.checked=s.get("normal")==="1"),e.statusCheckboxes.limited&&(e.statusCheckboxes.limited.checked=s.get("limited")==="1"),e.statusCheckboxes.stopped&&(e.statusCheckboxes.stopped.checked=s.get("stop")==="1")}async function G(){const s=e.yjCodeInput?.value?.trim()||"",a=new URLSearchParams;s&&a.set("yj",s),a.set("class3",e.checkboxes.class3?.checked?"1":"0"),a.set("class4",e.checkboxes.class4?.checked?"1":"0"),a.set("ingredient",e.checkboxes.ingredient?.checked?"1":"0"),a.set("form",e.checkboxes.form?.checked?"1":"0"),a.set("standard",e.checkboxes.standard?.checked?"1":"0"),a.set("brand",e.checkboxes.brand?.checked?"1":"0"),a.set("normal",e.statusCheckboxes.normal?.checked?"1":"0"),a.set("limited",e.statusCheckboxes.limited?.checked?"1":"0"),a.set("stop",e.statusCheckboxes.stopped?.checked?"1":"0");const r=`${window.location.origin+window.location.pathname}?${a.toString()}`;try{await navigator.clipboard.writeText(r),h("検索条件のURLをクリップボードにコピーしました","success")}catch(t){console.error("Failed to copy to clipboard:",t),h("URLのコピーに失敗しました","error")}}let B=[];function w(s){if(B.length===0){h("ソートするデータがありません。","info");return}const a=y[s]==="asc"?"desc":"asc";y[s]=a;for(const t in y)if(t!==s){y[t]="asc";const l=e.sortIcons[t];l&&(l.textContent="↕")}const u=e.sortIcons[s];u&&(u.textContent=a==="asc"?"↑":"↓"),B.sort((t,l)=>{let n,i;s==="status"?(n=(t.shipmentStatus||"").trim(),i=(l.shipmentStatus||"").trim()):s==="productName"?(n=(t.productName||"").trim(),i=(l.productName||"").trim()):s==="ingredientName"?(n=(t.ingredientName||"").trim(),i=(l.ingredientName||"").trim()):s==="yjCode"&&(n=(t.yjCode||"").trim(),i=(l.yjCode||"").trim());const c=n.localeCompare(i,"ja",{sensitivity:"base"});return a==="asc"?c:-c}),S(B);let r="";switch(s){case"status":r="出荷状況";break;case"productName":r="品名";break;case"ingredientName":r="成分名";break;case"yjCode":r="YJコード";break}h(`「${r}」を${a==="asc"?"昇順":"降順"}でソートしました。`,"success")}function N(){const s=e.yjCodeInput.value;let a=E(s);const u={class3:e.checkboxes.class3?.checked||!1,class4:e.checkboxes.class4?.checked||!1,ingredient:e.checkboxes.ingredient?.checked||!1,form:e.checkboxes.form?.checked||!1,standard:e.checkboxes.standard?.checked||!1,brand:e.checkboxes.brand?.checked||!1},r={normal:e.statusCheckboxes.normal?.checked||!1,limited:e.statusCheckboxes.limited?.checked||!1,stopped:e.statusCheckboxes.stopped?.checked||!1},t=Object.values(u).some(n=>n),l=Object.values(r).some(n=>n);if(t){if(!a||!/^[0-9a-zA-Z]+$/.test(a)){h("検索条件をチェックした際は、正しいYJコードを入力してください。","error"),S([]);return}let n=a;n.length<12&&/^\d+$/.test(n)&&(n=n.padStart(12,"0"),console.log(`Padded YJ code to: ${n}`)),a=n}if(!t&&!l){h("検索条件と出荷状況のチェックを全て外したため、検索結果は表示されません。","info"),S([]);return}B=j.filter(n=>{const i=E(n.yjCode||"");if(!i)return!1;if(t){let c=!0;if(u.brand&&(i.startsWith(a.substring(0,11))||(c=!1)),c&&u.ingredient&&(i.startsWith(a.substring(0,7))||(c=!1)),c&&u.class4&&(i.startsWith(a.substring(0,4))||(c=!1)),c&&u.class3&&(i.startsWith(a.substring(0,3))||(c=!1)),c&&u.form&&i.charAt(7)!==a.charAt(7)&&(c=!1),c&&u.standard&&i.charAt(8)!==a.charAt(8)&&(c=!1),!c)return!1}if(l){const c=E(n.shipmentStatus||"");let m=!1;if(r.normal&&(c.includes("通常出荷")||c.includes("通"))&&(m=!0),r.limited&&(c.includes("限定出荷")||c.includes("出荷制限")||c.includes("限")||c.includes("制"))&&(m=!0),r.stopped&&(c.includes("供給停止")||c.includes("停止")||c.includes("停"))&&(m=!0),!m)return!1}return!0}),y.status="asc",y.productName="asc",y.ingredientName="asc",y.yjCode="asc",e.sortIcons.status&&(e.sortIcons.status.textContent="↕"),e.sortIcons.productName&&(e.sortIcons.productName.textContent="↕"),e.sortIcons.ingredientName&&(e.sortIcons.ingredientName.textContent="↕"),e.sortIcons.yjCode&&(e.sortIcons.yjCode.textContent="↕"),S(B),scrollTo(0,0),B.length===0?h("条件に一致するデータが見つかりませんでした。","info"):h(`${B.length} 件見つかりました。`,"success")}function S(s){const a=window.innerWidth<=640;if(e.resultTableBody.innerHTML="",e.cardContainer.innerHTML="",s.length===0){e.tableContainer.classList.add("hidden"),e.cardContainer.classList.add("hidden"),document.body.classList.remove("search-mode");return}document.body.classList.add("search-mode");const u=s.slice(0,500),r={productName:5,ingredientName:2,manufacturer:6,shipmentStatus:11};a?(e.tableContainer.classList.add("hidden"),e.cardContainer.classList.remove("hidden"),e.cardContainer.classList.add("search-results-grid"),u.forEach((t,l)=>{const n=document.createElement("div");n.className="search-result-card bg-white p-4 rounded-lg shadow-sm border border-gray-200 transition-all duration-150 fade-in-up",n.style.animationDelay=l===0?"0s":`${l*.05}s`;const i=document.createElement("div");i.className="text-sm font-mono text-gray-800 mb-1";const c=document.createElement("span");if(c.className="font-semibold text-gray-500 mr-2",c.textContent="YJコード:",i.appendChild(c),t.yjCode){const d=document.createElement("a");d.href=`index.html?yjcode=${t.yjCode}&mode=alternative`,d.className="text-indigo-600 font-semibold hover:underline",d.textContent=t.yjCode,i.appendChild(d)}else i.textContent+="";n.appendChild(i);const m=document.createElement("div");m.className="flex flex-col items-start mb-2";const p=document.createElement("div");p.className="flex gap-1 mb-1";const D=t.productCategory&&E(t.productCategory).includes("後発品"),$=t.isBasicDrug&&E(t.isBasicDrug).includes("基礎的医薬品");if(D){const d=document.createElement("span");d.className="bg-green-100 text-green-800 px-1.5 py-0.5 rounded text-[10px] font-bold whitespace-nowrap border border-green-200",d.textContent="後発",p.appendChild(d)}if($){const d=document.createElement("span");d.className="bg-purple-100 text-purple-800 px-1.5 py-0.5 rounded text-[10px] font-bold whitespace-nowrap border border-purple-200",d.textContent="基礎",p.appendChild(d)}p.hasChildNodes()&&m.appendChild(p);const f=document.createElement("div");if(f.className="flex items-center",t.yjCode){const d=R(t,s.indexOf(t));f.appendChild(d)}else{const d=document.createElement("span");d.textContent=t.productName||"",d.className=`${t.updatedCells&&t.updatedCells.includes(r.productName)?"text-red-600 font-bold":""}`,f.appendChild(d)}m.appendChild(f),n.appendChild(m);const b=document.createElement("div");b.className="text-sm text-gray-700 mb-2";const g=document.createElement("span");g.className="font-semibold text-gray-500 mr-2",g.textContent="成分名:",b.appendChild(g);const k=document.createElement("span");k.textContent=t.ingredientName||"",k.className=`${t.updatedCells&&t.updatedCells.includes(r.ingredientName)?"text-red-600 font-bold":""}`,b.appendChild(k),n.appendChild(b);const x=document.createElement("div");x.className="text-sm text-gray-700 mb-2";const I=document.createElement("span");I.className="font-semibold text-gray-500 mr-2",I.textContent="メーカー:",x.appendChild(I);const C=document.createElement("span"),o=t.manufacturer||"";if(L[o]){const d=document.createElement("a");d.href=L[o],d.target="_blank",d.rel="noopener noreferrer",d.className="text-indigo-600 hover:underline",d.textContent=o,C.appendChild(d)}else C.textContent=o;C.className=`${C.className} ${t.updatedCells&&t.updatedCells.includes(r.manufacturer)?"text-red-600 font-bold":""}`,x.appendChild(C),n.appendChild(x);const v=document.createElement("div");v.className="flex items-center gap-2";const A=document.createElement("span");A.className="font-semibold text-gray-500 mr-2",A.textContent="出荷状況:",v.appendChild(A);const U=t.updatedCells&&t.updatedCells.includes(r.shipmentStatus);if(v.appendChild(M(t.shipmentStatus,U)),t.shippingStatusTrend){const d=document.createElement("span");d.className="text-base text-red-500 font-bold",d.textContent=t.shippingStatusTrend,v.appendChild(d)}n.appendChild(v),e.cardContainer.appendChild(n)})):(e.tableContainer.classList.remove("hidden"),e.cardContainer.classList.add("hidden"),u.forEach((t,l)=>{const n=e.resultTableBody.insertRow(),i=l%2===1?"bg-gray-50":"bg-white";n.className=`${i} hover:bg-indigo-50 transition-colors group fade-in-up`,n.style.animationDelay=l===0?"0s":`${l*.05}s`;const c=n.insertCell(0);if(c.className="px-4 py-2 text-sm font-mono align-top",c.setAttribute("data-label","YJコード"),t.yjCode){const o=document.createElement("a");o.href=`index.html?yjcode=${t.yjCode}&mode=alternative`,o.className="text-indigo-600 font-semibold hover:underline",o.textContent=t.yjCode,c.appendChild(o)}else c.textContent="";const m=n.insertCell(1);m.className="px-4 py-2 text-sm text-gray-900 font-medium align-top",m.setAttribute("data-label","品名");const p=document.createElement("div");p.className="vertical-labels-container";const D=t.productCategory&&E(t.productCategory).includes("後発品"),$=t.isBasicDrug&&E(t.isBasicDrug).includes("基礎的医薬品");if(D){const o=document.createElement("span");o.className="medicine-badge badge-generic",o.textContent="後",p.appendChild(o)}if($){const o=document.createElement("span");o.className="medicine-badge badge-basic",o.textContent="基",p.appendChild(o)}const f=document.createElement("div");if(f.className="flex items-start",p.hasChildNodes()&&f.appendChild(p),t.yjCode)f.appendChild(R(t,s.indexOf(t)));else{const o=document.createElement("span");o.textContent=t.productName||"",f.appendChild(o)}m.appendChild(f),t.updatedCells&&t.updatedCells.includes(r.productName)&&m.classList.add("text-red-600","font-bold");const b=n.insertCell(2);b.className="px-4 py-2 text-sm text-gray-600 align-top",b.setAttribute("data-label","成分名"),b.textContent=t.ingredientName||"",t.updatedCells&&t.updatedCells.includes(r.ingredientName)&&b.classList.add("text-red-600","font-bold");const g=n.insertCell(3);g.className="px-4 py-2 text-sm text-gray-600 align-top",g.setAttribute("data-label","メーカー");const k=t.manufacturer||"";if(L[k]){const o=document.createElement("a");o.href=L[k],o.target="_blank",o.rel="noopener noreferrer",o.className="text-indigo-600 hover:underline",o.textContent=k,g.appendChild(o)}else g.textContent=k;t.updatedCells&&t.updatedCells.includes(r.manufacturer)&&g.classList.add("text-red-600","font-bold");const x=n.insertCell(4);x.className="px-4 py-2 align-top",x.setAttribute("data-label","出荷状況");const I=t.updatedCells&&t.updatedCells.includes(r.shipmentStatus),C=document.createElement("div");if(C.className="flex items-center gap-1",C.appendChild(M(t.shipmentStatus,I)),t.shippingStatusTrend){const o=document.createElement("span");o.className="text-base text-red-500 font-bold",o.textContent=t.shippingStatusTrend,C.appendChild(o)}x.appendChild(C),I&&x.classList.add("text-red-600","font-bold")}))}document.addEventListener("DOMContentLoaded",W);document.addEventListener("DOMContentLoaded",()=>{const s=document.getElementById("yjCodeInput");J(s,"YJコード (例: 1124009F1020)",100)});
