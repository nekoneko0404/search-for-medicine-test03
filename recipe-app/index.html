<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>健康レシピ提案 - Kusuri Compass</title>
    <meta name="description" content="気になる症状や食材から、あなたにぴったりの健康レシピをAIが提案します。">

    <!-- OGP -->
    <meta property="og:title" content="健康レシピ提案 - Kusuri Compass">
    <meta property="og:description" content="気になる症状や食材から、あなたにぴったりの健康レシピをAIが提案します。">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://kiyoshi.github.io/search-for-medicine/recipe-app/">
    <meta property="og:image" content="https://kiyoshi.github.io/search-for-medicine/recipe-app/ogp.jpg">

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="健康レシピ提案 - Kusuri Compass">
    <meta name="twitter:image" content="https://kiyoshi.github.io/search-for-medicine/recipe-app/ogp.jpg">

    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-H44R8N7W32"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'G-H44R8N7W32');
    </script>

    <!-- Tailwind CSS -->
    <script src="https://cdn.jsdelivr.net/npm/tailwindcss-cdn@3.4.1/tailwindcss.js"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css">
    <!-- Google Fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@400;500;700&family=Inter:wght@400;500;700&display=swap"
        rel="stylesheet">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/style.css">
</head>

<body class="bg-orange-50 font-['M_PLUS_Rounded_1c'] text-gray-800">

    <!-- Header -->
    <header class="bg-white/80 backdrop-blur-md shadow-sm sticky top-0 z-50">
        <div class="max-w-4xl mx-auto px-4 py-3 flex items-center justify-between">
            <a href="../index.html" class="flex items-center gap-2 hover:opacity-80 transition-opacity">
                <i class="fas fa-chevron-left text-orange-500"></i>
                <span class="font-bold text-gray-600">Kusuri Compassに戻る</span>
            </a>
            <h1 class="text-xl font-bold text-orange-600 flex items-center gap-2">
                <i class="fas fa-utensils"></i>
                健康レシピ提案
            </h1>
        </div>
    </header>

    <main class="max-w-4xl mx-auto px-4 py-8">

        <!-- Hero Section -->
        <div class="text-center mb-10 fade-in">
            <div
                class="relative w-full max-w-lg mx-auto mb-6 aspect-video bg-orange-100 rounded-2xl overflow-hidden shadow-inner flex items-center justify-center">
                <!-- Image placeholder or generated image -->
                <img src="../images/recipe_app_hero_stylish.png" alt="Healthy Ingredients"
                    class="object-cover w-full h-full"
                    onerror="this.src='https://placehold.co/600x400/orange/white?text=Cooking+Time!';">
            </div>
            <h2 class="text-3xl md:text-4xl font-bold text-orange-800 mb-4">今日のごはんは何にする？</h2>
            <p class="text-lg text-orange-700/80">体調や気分に合わせて、AIがあなただけのレシピを考えます！</p>
        </div>

        <!-- Form Section -->
        <div class="bg-white rounded-3xl shadow-xl p-6 md:p-10 mb-10 fade-in-up">

            <form id="recipe-form" class="space-y-8">

                <!-- 1. Symptoms -->
                <div class="form-group">
                    <label class="block text-lg font-bold text-gray-700 mb-3">
                        <span class="bg-orange-100 text-orange-600 rounded-full px-3 py-1 text-sm mr-2">Step 1</span>
                        気になること・体調（複数選択可）
                    </label>

                    <!-- Medical Disclaimer -->
                    <div
                        class="mb-4 bg-blue-50 border border-blue-200 text-blue-800 px-4 py-3 rounded-xl text-sm flex items-start gap-3">
                        <i class="fas fa-info-circle mt-1 text-blue-500"></i>
                        <div>
                            <p class="font-bold mb-1">ご利用にあたって</p>
                            <p class="text-blue-700/80 leading-relaxed">
                                このサービスは、毎日の食事選びをサポートするものであり、医療行為や治療を目的としたものではありません。
                                <br>現在治療中の病気や、深刻な体調不良がある場合は、必ず医師や専門機関にご相談ください。
                            </p>
                        </div>
                    </div>

                    <div class="flex flex-wrap gap-2 mb-3" id="symptoms-container">
                        <!-- Generated by JS -->
                    </div>
                    <!-- 'Others' Input -->
                    <div class="mt-2">
                        <label class="block text-sm font-bold text-gray-600 mb-1">その他（自由記述）</label>
                        <input type="text" name="other_symptom" placeholder="例：食欲がない、二日酔い..."
                            class="form-input text-sm">
                    </div>
                </div>

                <!-- 2. Ingredients -->
                <div class="form-group">
                    <label class="block text-lg font-bold text-gray-700 mb-3">
                        <span class="bg-orange-100 text-orange-600 rounded-full px-3 py-1 text-sm mr-2">Step 2</span>
                        使いたい食材（3つまで・任意）
                    </label>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
                        <input type="text" name="ingredient" placeholder="例：キャベツ" class="form-input">
                        <input type="text" name="ingredient" placeholder="例：豚肉" class="form-input">
                        <input type="text" name="ingredient" placeholder="例：豆腐" class="form-input">
                    </div>
                </div>

                <!-- 2.5 Excluded Ingredients -->
                <div class="form-group">
                    <label class="block text-lg font-bold text-gray-700 mb-3">
                        <span class="bg-gray-100 text-gray-600 rounded-full px-3 py-1 text-sm mr-2">Step 2.5</span>
                        除外したい食材（3つまで・任意）
                    </label>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
                        <input type="text" name="excluded_ingredient" placeholder="例：卵" class="form-input">
                        <input type="text" name="excluded_ingredient" placeholder="例：そば" class="form-input">
                        <input type="text" name="excluded_ingredient" placeholder="例：豚肉" class="form-input">
                    </div>
                </div>

                <!-- 3. Cuisine & Time -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-lg font-bold text-gray-700 mb-3">
                            <span class="bg-orange-100 text-orange-600 rounded-full px-3 py-1 text-sm mr-2">Step
                                3</span>
                            ジャンル
                        </label>
                        <div class="grid grid-cols-2 lg:grid-cols-3 gap-4">
                            <!-- 1. 和食 -->
                            <label>
                                <input type="radio" name="cuisine" value="和食" checked class="peer hidden">
                                <span
                                    class="bg-white border-2 border-gray-200 rounded-xl px-2 py-3 block text-center cursor-pointer hover:border-orange-300 transition-all peer-checked:border-orange-500 peer-checked:bg-orange-50 peer-checked:text-orange-700 peer-checked:ring-2 peer-checked:ring-orange-200 peer-checked:ring-offset-2 flex flex-col items-center justify-center h-full">
                                    <span class="block text-2xl mb-1">🍱</span>
                                    <span class="font-bold text-sm">和食</span>
                                </span>
                            </label>
                            <!-- 2. 中華料理 -->
                            <label>
                                <input type="radio" name="cuisine" value="中華料理" class="peer hidden">
                                <span
                                    class="bg-white border-2 border-gray-200 rounded-xl px-2 py-3 block text-center cursor-pointer hover:border-orange-300 transition-all peer-checked:border-orange-500 peer-checked:bg-orange-50 peer-checked:text-orange-700 peer-checked:ring-2 peer-checked:ring-orange-200 peer-checked:ring-offset-2 flex flex-col items-center justify-center h-full">
                                    <span class="block text-2xl mb-1">🥟</span>
                                    <span class="font-bold text-sm">中華料理</span>
                                </span>
                            </label>
                            <!-- 3. 韓国料理 -->
                            <label>
                                <input type="radio" name="cuisine" value="韓国料理" class="peer hidden">
                                <span
                                    class="bg-white border-2 border-gray-200 rounded-xl px-2 py-3 block text-center cursor-pointer hover:border-orange-300 transition-all peer-checked:border-orange-500 peer-checked:bg-orange-50 peer-checked:text-orange-700 peer-checked:ring-2 peer-checked:ring-orange-200 peer-checked:ring-offset-2 flex flex-col items-center justify-center h-full">
                                    <span class="block text-2xl mb-1">🥢</span>
                                    <span class="font-bold text-sm">韓国料理</span>
                                </span>
                            </label>
                            <!-- 4. ヨーロッパ料理 -->
                            <label>
                                <input type="radio" name="cuisine" value="ヨーロッパ料理" class="peer hidden">
                                <span
                                    class="bg-white border-2 border-gray-200 rounded-xl px-2 py-3 block text-center cursor-pointer hover:border-orange-300 transition-all peer-checked:border-orange-500 peer-checked:bg-orange-50 peer-checked:text-orange-700 peer-checked:ring-2 peer-checked:ring-orange-200 peer-checked:ring-offset-2 flex flex-col items-center justify-center h-full">
                                    <span class="block text-2xl mb-1">🍝</span>
                                    <span class="font-bold text-sm">ヨーロッパ料理</span>
                                </span>
                            </label>
                            <!-- 5. 地中海料理 -->
                            <label>
                                <input type="radio" name="cuisine" value="地中海料理" class="peer hidden">
                                <span
                                    class="bg-white border-2 border-gray-200 rounded-xl px-2 py-3 block text-center cursor-pointer hover:border-orange-300 transition-all peer-checked:border-orange-500 peer-checked:bg-orange-50 peer-checked:text-orange-700 peer-checked:ring-2 peer-checked:ring-orange-200 peer-checked:ring-offset-2 flex flex-col items-center justify-center h-full">
                                    <span class="block text-2xl mb-1">🫒</span>
                                    <span class="font-bold text-sm">地中海料理</span>
                                </span>
                            </label>
                            <!-- 6. アラブ料理 -->
                            <label>
                                <input type="radio" name="cuisine" value="アラブ料理" class="peer hidden">
                                <span
                                    class="bg-white border-2 border-gray-200 rounded-xl px-2 py-3 block text-center cursor-pointer hover:border-orange-300 transition-all peer-checked:border-orange-500 peer-checked:bg-orange-50 peer-checked:text-orange-700 peer-checked:ring-2 peer-checked:ring-orange-200 peer-checked:ring-offset-2 flex flex-col items-center justify-center h-full">
                                    <span class="block text-2xl mb-1">🥙</span>
                                    <span class="font-bold text-sm">アラブ料理</span>
                                </span>
                            </label>
                            <!-- 7. インド料理 -->
                            <label>
                                <input type="radio" name="cuisine" value="インド料理" class="peer hidden">
                                <span
                                    class="bg-white border-2 border-gray-200 rounded-xl px-2 py-3 block text-center cursor-pointer hover:border-orange-300 transition-all peer-checked:border-orange-500 peer-checked:bg-orange-50 peer-checked:text-orange-700 peer-checked:ring-2 peer-checked:ring-orange-200 peer-checked:ring-offset-2 flex flex-col items-center justify-center h-full">
                                    <span class="block text-2xl mb-1">🍛</span>
                                    <span class="font-bold text-sm">インド料理</span>
                                </span>
                            </label>
                            <!-- 8. アフリカ料理 -->
                            <label>
                                <input type="radio" name="cuisine" value="アフリカ料理" class="peer hidden">
                                <span
                                    class="bg-white border-2 border-gray-200 rounded-xl px-2 py-3 block text-center cursor-pointer hover:border-orange-300 transition-all peer-checked:border-orange-500 peer-checked:bg-orange-50 peer-checked:text-orange-700 peer-checked:ring-2 peer-checked:ring-orange-200 peer-checked:ring-offset-2 flex flex-col items-center justify-center h-full">
                                    <span class="block text-2xl mb-1">🍲</span>
                                    <span class="font-bold text-sm">アフリカ料理</span>
                                </span>
                            </label>
                            <!-- 9. 南米料理 -->
                            <label>
                                <input type="radio" name="cuisine" value="南米料理" class="peer hidden">
                                <span
                                    class="bg-white border-2 border-gray-200 rounded-xl px-2 py-3 block text-center cursor-pointer hover:border-orange-300 transition-all peer-checked:border-orange-500 peer-checked:bg-orange-50 peer-checked:text-orange-700 peer-checked:ring-2 peer-checked:ring-orange-200 peer-checked:ring-offset-2 flex flex-col items-center justify-center h-full">
                                    <span class="block text-2xl mb-1">🌮</span>
                                    <span class="font-bold text-sm">南米料理</span>
                                </span>
                            </label>
                        </div>
                    </div>

                    <div>
                        <label class="block text-lg font-bold text-gray-700 mb-3">
                            <span class="bg-orange-100 text-orange-600 rounded-full px-3 py-1 text-sm mr-2">Step
                                4</span>
                            調理時間
                        </label>
                        <div class="flex gap-2">
                            <label class="flex-1">
                                <input type="radio" name="time" value="10分以内" class="peer hidden">
                                <span
                                    class="bg-white border-2 border-gray-200 rounded-xl px-2 py-3 block text-center cursor-pointer hover:border-orange-300 transition-all peer-checked:border-orange-500 peer-checked:bg-orange-50 peer-checked:text-orange-700 peer-checked:ring-2 peer-checked:ring-orange-200 peer-checked:ring-offset-2">
                                    <span class="block text-sm font-bold">時短</span>
                                    <span class="text-xs text-gray-500">10分以内</span>
                                </span>
                            </label>
                            <label class="flex-1">
                                <input type="radio" name="time" value="30分以内" checked class="peer hidden">
                                <span
                                    class="bg-white border-2 border-gray-200 rounded-xl px-2 py-3 block text-center cursor-pointer hover:border-orange-300 transition-all peer-checked:border-orange-500 peer-checked:bg-orange-50 peer-checked:text-orange-700 peer-checked:ring-2 peer-checked:ring-orange-200 peer-checked:ring-offset-2">
                                    <span class="block text-sm font-bold">普通</span>
                                    <span class="text-xs text-gray-500">30分以内</span>
                                </span>
                            </label>
                            <label class="flex-1">
                                <input type="radio" name="time" value="こだわらない" class="peer hidden">
                                <span
                                    class="bg-white border-2 border-gray-200 rounded-xl px-2 py-3 block text-center cursor-pointer hover:border-orange-300 transition-all peer-checked:border-orange-500 peer-checked:bg-orange-50 peer-checked:text-orange-700 peer-checked:ring-2 peer-checked:ring-orange-200 peer-checked:ring-offset-2">
                                    <span class="block text-sm font-bold">じっくり</span>
                                    <span class="text-xs text-gray-500">30分以上</span>
                                </span>
                            </label>
                        </div>
                    </div>
                </div>

                <!-- 4. Advanced Settings (API) -->
                <div class="border-t border-gray-100 pt-6 mt-6">
                    <button type="button" id="advanced-settings-toggle"
                        class="text-sm text-gray-500 hover:text-orange-500 flex items-center gap-1 transition-colors">
                        <i class="fas fa-cog"></i> 詳細設定 (AIモデル・APIキー)
                    </button>

                    <div id="advanced-settings"
                        class="hidden mt-4 p-5 bg-gray-50 rounded-xl border border-gray-200 text-sm">

                        <div class="space-y-4">
                            <label class="block font-bold text-gray-700">使用するAIモデルとキー設定</label>

                            <!-- Option 1: System (Gemini Free) -->
                            <label
                                class="flex items-start gap-3 cursor-pointer p-3 bg-white border border-gray-200 rounded-lg hover:border-orange-300 transition-all">
                                <input type="radio" name="api_option" value="system" checked
                                    class="mt-1 text-orange-500 focus:ring-orange-500">
                                <div>
                                    <span class="block font-bold text-gray-800">おまかせ (無料)</span>
                                    <span class="text-xs text-gray-500">Google Gemini 3 Flash Preview
                                        を使用します。1日の利用回数に制限があります。</span>
                                </div>
                            </label>

                            <!-- Option 2: OpenAI (Own Key) -->
                            <label
                                class="flex items-start gap-3 cursor-pointer p-3 bg-white border border-gray-200 rounded-lg hover:border-orange-300 transition-all">
                                <input type="radio" name="api_option" value="openai"
                                    class="mt-1 text-orange-500 focus:ring-orange-500">
                                <div>
                                    <span class="block font-bold text-gray-800">OpenAI (自分のキーを使用)</span>
                                    <span class="text-xs text-gray-500">GPT-4o miniを使用します。ご自身のAPIキーが必要です。</span>
                                </div>
                            </label>

                            <!-- Option 3: Gemini (Own Key) -->
                            <label
                                class="flex items-start gap-3 cursor-pointer p-3 bg-white border border-gray-200 rounded-lg hover:border-orange-300 transition-all">
                                <input type="radio" name="api_option" value="gemini"
                                    class="mt-1 text-orange-500 focus:ring-orange-500">
                                <div>
                                    <span class="block font-bold text-gray-800">Google Gemini (自分のキーを使用)</span>
                                    <span class="text-xs text-gray-500">Gemini 3 Flash
                                        Previewを使用します。ご自身のAPIキーが必要です。</span>
                                </div>
                            </label>
                        </div>

                        <!-- API Key Input (Hidden by default) -->
                        <div id="api-key-input-container" class="hidden mt-4 pl-8">
                            <input type="password" id="api-key" placeholder="APIキーを入力 (sk-...)"
                                class="w-full px-4 py-2 rounded-lg border border-gray-300 focus:border-orange-500 focus:ring-2 focus:ring-orange-200 outline-none transition-all">
                            <div class="mt-2 p-3 bg-red-50 border border-red-100 rounded-lg">
                                <p class="text-xs text-red-600 font-bold mb-1">
                                    <i class="fas fa-exclamation-triangle mr-1"></i>重要：APIキーのリスクについて
                                </p>
                                <p class="text-xs text-gray-600 leading-relaxed">
                                    入力されたキーはサーバー(Worker)を経由してAI呼び出しにのみ使用されます。サーバーには保存されませんが、ネットカフェや公共のPCでは入力しないでください。
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Submit Button -->
                <div class="text-center pt-4">
                    <button type="submit" id="generate-btn"
                        class="group relative inline-flex items-center justify-center px-8 py-4 text-lg font-bold text-white transition-all duration-200 bg-orange-500 font-pj rounded-full focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-600 hover:bg-orange-600 shadow-lg hover:shadow-orange-300/50 hover:-translate-y-1">
                        <span class="mr-2 text-2xl group-hover:animate-bounce">🍳</span>
                        レシピを提案してもらう
                        <i class="fas fa-magic ml-2"></i>
                    </button>
                </div>
            </form>
        </div>

        <!-- Result Section -->
        <div id="result-section" class="hidden">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-2xl font-bold text-gray-800">
                    <i class="fas fa-sparkles text-yellow-500 mr-2"></i>提案レシピ
                </h3>
                <button id="print-btn" type="button"
                    class="hidden md:inline-flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg transition-colors text-sm font-bold">
                    <i class="fas fa-print"></i> 印刷する
                </button>
            </div>

            <div id="loading" class="hidden flex flex-col items-center justify-center py-12">
                <div class="animate-spin rounded-full h-16 w-16 border-b-4 border-orange-500 mb-4"></div>
                <p class="text-orange-600 font-bold animate-pulse">AIシェフがレシピを考案中...</p>
                <p class="text-sm text-gray-500 mt-2">※生成には30秒ほどかかる場合があります</p>
            </div>

            <div id="recipe-cards" class="flex flex-col gap-6 w-full">
                <!-- Recipes will be injected here -->
            </div>
        </div>

    </main>

    <footer class="text-center py-6 text-gray-500 text-sm">
        <p>&copy; 2024 Kusuri Compass - Recipe Suggestion App</p>
        <p class="text-xs mt-1">※提案されたレシピは参考情報です。アレルギーや医師の指示に従ってください。</p>
    </footer>

    <script src="js/script.js" type="module"></script>
</body>

</html>